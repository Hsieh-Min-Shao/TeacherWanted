<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- bootstrap相關 -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ"
      crossorigin="anonymous"
    ></script>
    <!-- bootstrap相關 -->
    <link href="../css/basebbs.css" rel="stylesheet" type="text/css" />
    <link href="../css/active/active.css" rel="stylesheet" type="text/css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@100;300;400;500;700;900&display=swap"
      rel="stylesheet"
    />
    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="docs/images/favicon.ico"
    />

    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"
      integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI="
      crossorigin=""
    />
    <script
      src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"
      integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM="
      crossorigin=""
    ></script>
    <!-- jquery套件 -->
    <script src="../jquery/jquery-3.6.4.min.js"></script>
    <!-- axios套件 -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script> -->
    <script src="../axios/axios.js"></script>
    <!-- vue3套件 -->
    <!-- <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script> -->
    <script src="../vue/vue-3.3.4.js"></script>
    <!-- 要登入驗證請解開這個 -->
    <!-- <script src="../js/loginCheck.js"></script> -->
    <!-- js匯入 -->
    <script src="../js/base.js"></script>
    <script src="../js/active/active.js"></script>

    <title>Document</title>
  </head>

  <body class="TeacherWanted">
    <!-- 手機板導引列(粗糙) -->
    <header class="TeacherWanted">
      <div id="mySidebar">
        <img src="../img/base/logo.png" alt="" />
        <a href="/index" class="">首頁</a>
        <a href="/courseteacher/CourseVue.html" class="">課程</a>
        <a href="/active/activeIndex.html" class="">活動</a>
        <a href="/wish" class="">許願池</a>
        <a href="/bbsdiscuss/index.html?posttype=all" class="">論壇</a>
        <a href="/baseVer3/homepage.html" class="">商城</a>
      </div>
      <div class="navBar">
        <ul class="containerHearder flexWrap flexVerticalCenter">
          <li>
            <img
              src="../img/base/menu.png"
              id="phoneMenu"
              class="mobileHave"
              style="height: 30px; margin: 10px"
              alt=""
            />
          </li>

          <li
            class="flexWrap flexAllCenter"
            style="font-size: 50px; color: #a4c964; margin: 10px 0px"
          >
            <img
              src="../img/base/logo.png"
              class="miniMobile"
              style="height: 50px; margin: 0px 5px"
              alt=""
            />
            <p>懸賞啼雀</p>
          </li>
          <li
            class="flexWrap"
            style="
              flex-grow: 1;
              display: flex;
              align-items: center;
              justify-content: end;
            "
          >
            <!-- 電腦版導引列 -->
            <div
              id="navLink"
              class="flexWrap flexAllCenter pcHave"
              style="flex-grow: 1"
            >
              <a class="flexAllCenter" href="/index">首頁</a>
              <a class="flexAllCenter" href="/courseteacher/CourseVue.html"
                >課程</a
              >
              <a class="flexAllCenter" href="/active/activeIndex.html">活動</a>
              <a class="flexAllCenter" href="/wish">許願池</a>
              <a class="flexAllCenter" href="/bbsdiscuss/index.html?posttype=all">論壇</a>
              <a class="flexAllCenter" href="/baseVer3/homepage.html">商城</a>
            </div>
            <div
              class="flexWrap flexAllCenter"
              style="position: relative; top: 2px"
            >
              <div class="miniMobile">
                <div id="navSearch" action="">
                  <select id="serchType">
                    <option value="課程">課程</option>
                    <option value="活動">活動</option>
                    <!-- <option value="商城">商城</option>
                    <option value="許願">許願</option> -->
                  </select>
                  <input id="searchText" type="text" />
                  <img id="searchIcon" src="../img/base/search.svg" alt="" />
                </div>
              </div>

              <img
                src="../img/base/bell.svg"
                id="navAnn"
                class="miniMobile"
                style="height: 30px; margin: 3px 5px; cursor: pointer"
                alt=""
              />
              <img
                src="../img/base/mailForNavbar.svg"
                id="navMail"
                class="miniMobile"
                style="
                  height: 30px;
                  margin: 3px 5px;
                  cursor: pointer;
                  position: relative;
                  bottom: 1px;
                "
                alt=""
              />
              <img
                src="../img/base/shoppingCart.svg"
                id="navShoppingcart"
                class="miniMobile"
                style="height: 30px; margin: 3px 5px; cursor: pointer"
                alt=""
              />

              <!--登入按鈕 開始 -->

              <div id="loginOrUser"></div>
              <!-- 登入按鈕 結束 -->
            </div>
          </li>
        </ul>
      </div>
    </header>
    <main class="TeacherWanted">
      <!-- ！！！寫在這裡！！！
      如果要讓區塊至中的話可以使用containerBase這個class(目前寬度1140px) -->
      <div class="container-fluid">
        <!-- 發表文章/發文紀錄/搜尋 -->
        <div>
          <nav class="navbar navbar-light bg-light">
            <div class="container-fluid">
              <div class="col-1">
                <button type="button" class="btn btn-outline-success btn_edit">
                  發表文章
                </button>
              </div>
              <div class="col">
                <button
                  type="button"
                  class="btn btn-outline-success btn_posting_record"
                >
                  發文紀錄
                </button>
              </div>
              <!-- <form class="d-flex">
                <input
                  class="form-control me-2"
                  type="search"
                  placeholder="查詢文章請輸入..."
                  aria-label="Search"
                />
                <button class="btn btn-outline-success" type="submit">
                  Search
                </button>
              </form> -->
            </div>
          </nav>
        </div>

        <div class="row">
          <div class="col-md-2 mt-3">
            <!-- 側邊欄 -->
            <div class="list-group" id="list-tab" role="tablist">
              <a
                class="list-group-item list-group-item-action active bbs_kb_lg"
                data-bs-toggle="list"
                href="#list-home"
                role="tab"
                aria-controls="list-home" onclick="go_herf('語言討論版')"
                >語言討論版</a
              >
              <a
                class="list-group-item list-group-item-action bbs_kb_pg"
                data-bs-toggle="list"
                href="#list-profile"
                role="tab"
                aria-controls="list-profile"  onclick="go_herf('程式討論版')"
                >程式討論版</a
              >
              <a
                class="list-group-item list-group-item-action bbs_kb_lf"
                data-bs-toggle="list"
                href="#list-messages"
                role="tab"
                aria-controls="list-messages" onclick="go_herf('生活討論版')"
                >生活討論版</a
              >
              <a
                class="list-group-item list-group-item-action bbs_kb_gm"
                data-bs-toggle="list"
                href="#list-settings"
                role="tab"
                aria-controls="list-settings" onclick="go_herf('電競討論版')"
                >電競討論版</a
              >
            </div>
          </div>
          <div class="col-md-9 mt-3">
            <!-- 收藏細項 -->
            <div class="container">
              <h1>我的收藏</h1>
              <nav style="--bs-breadcrumb-divider: '>'" aria-label="breadcrumb">
                <ol class="breadcrumb">
                  <li class="breadcrumb-item"><a href="/bbsdiscuss/index.html?posttype=all">論壇</a></li>
                  <li class="breadcrumb-item active" aria-current="page">
                    我的收藏
                  </li>
                </ol>
              </nav>
            </div>
            <div class="container bbs_no_fav">
              <ul
                class="row row-cols-1 row-cols-md-3 g-4 bbs_favorite_list"
              ></ul>
            </div>
          </div>
        </div>
      </div>
    </main>

    <footer
      class="TeacherWanted"
      style="background-color: #3c6a36; color: white"
    >
      <div
        class="containerFooter flexAllCenter"
        style="box-sizing: border-box; padding-top: 50px"
      >
        <div class="flexWrap">
          <ul class="col_33">
            <li class="flexAllCenter" style="color: #a4c964; font-size: 40px">
              懸賞啼雀
            </li>
            <li
              class="flexAllCenter"
              style="margin: 10px 30px; font-weight: normal"
            >
              現代⼈⽣活步相當緊湊我們的課平台幫助
              ⼈們學並且除了線上課提供了實家的合會⼤了學的⾯向
              課元可提⾼學⽣的學興積性 並促學⽣的⾯發展
            </li>
            <li
              id="imgIcon"
              class="flexVerticalCenter"
              style="margin: 20px 30px"
            >
              <img src="../img/base/facebook.svg" class="imgIntroduce" alt="" />
              <img src="../img/base/twitter.svg" class="imgIntroduce" alt="" />
              <img
                src="../img/base/instagram.svg"
                class="imgIntroduce"
                alt=""
              />
            </li>
          </ul>
          <ul class="col_33 flexHorizontalCenter footerMobile">
            <div style="width: 70%">
              <li
                class="flexAllCenter"
                style="color: #a4c964; font-size: 30px; height: 65px"
              >
                Get In Touch
              </li>
              <div class="" style="height: 250px; font-weight: 400">
                <li class="flexWrap" style="margin-top: 10px">
                  <img
                    src="../img/base/map-marker.svg"
                    style="height: 24px; padding-right: 10px; margin-top: 6px"
                    alt=""
                  />
                  <div>
                    <h3 style="font-size: 1.3rem">地址</h3>
                    <h5 style="font-size: 1rem">台北市中山區南京東路三段</h5>
                  </div>
                </li>

                <li class="flexWrap" style="margin-top: 10px">
                  <img
                    src="../img/base/mail.svg"
                    style="height: 24px; padding-right: 10px; margin-top: 6px"
                    alt=""
                  />
                  <div>
                    <h3 style="font-size: 1.3rem">信箱</h3>
                    <h5 style="font-size: 1rem">a1234567890@gmail.com</h5>
                  </div>
                </li>

                <li class="flexWrap" style="margin-top: 10px">
                  <img
                    src="../img/base/phone.svg"
                    style="height: 24px; padding-right: 10px; margin-top: 6px"
                    alt=""
                  />
                  <div>
                    <h3 style="font-size: 1.3rem">連絡電話</h3>
                    <h5 style="font-size: 1rem">0900123456</h5>
                  </div>
                </li>
              </div>
            </div>
          </ul>
          <ul class="col_33 flexHorizontalCenter footerMobile">
            <div style="width: 40%">
              <li
                class="flexAllCenter"
                style="color: #a4c964; font-size: 30px; height: 65px"
              >
                網站地圖
              </li>
              <div class="webMap">
                <li style="margin-top: 5px">
                  <a class="webMapLink" href="/index">>首頁</a>
                </li>
                <li style="margin-top: 5px">
                  <a class="webMapLink" href="/courseteacher/CourseVue.html"
                    >>課程</a
                  >
                </li>
                <li style="margin-top: 5px">
                  <a class="webMapLink" href="/active/activeIndex.html"
                    >>活動</a
                  >
                </li>
                <li style="margin-top: 5px">
                  <a class="webMapLink" href="/wish">>許願池</a>
                </li>
                <li style="margin-top: 5px">
                  <a class="webMapLink" href="/bbsdiscuss/index.html?posttype=all">>論壇</a>
                </li>
                <li style="margin-top: 5px">
                  <a class="webMapLink" href="/baseVer3/homepage.html">>商城</a>
                </li>
              </div>
            </div>
          </ul>
        </div>
      </div>
    </footer>

    <script>
      $(function () {
        // =================================查詢收藏列表===========================================================
        $.ajax({
          url: "/bbsdiscussGet/session",
          type: "GET",
          data: {},
          dataType: "json",
          success: function (data_id) {
            //   }
            // });
            $.ajax({
              url: "/bbsdiscussGet/fav",
              type: "GET",
              data: {},
              dataType: "json",
              success: function (data) {
                console.log(data);
                // 使用迴圈遍歷資料陣列
                for (let i = 0; i < data.length; i++) {
                  // 獲取每個資料項目的相關屬性值
                  let bbsPostId = data[i].bbsPostId;
                  let postTitle = data[i].postTitle;
                  let postContent = data[i].postContent;
                  let memId = data[i].memId;
                  let bbs_favorite_html = `
                  <li class="col-sm-4" style="list-style: none">
                    <div class="card" style="width: 18rem">
                      <div class="card-body">
                        <h5 class="card-title d-block text-truncate" style="max-width: 300px">
                          ${postTitle}
                        </h5>
                        <p class="card-text d-block text-truncate" style="max-width: 300px">
                          ${postContent}
                        </p>
                        <!-- Button trigger modal -->

                        <button id="bbs_cancel_favorite" type="button" class="btn btn-outline-danger bbs_cancel_favorite" style="display:inline" data-bs-toggle="modal" data-bs-target="#${bbsPostId}" >
                        取消收藏</button>
                        <p id="bbsPostId_cancel" style="display:inline; color:white " >${bbsPostId}</p>

                        <!-- Modal -->
                        <div class="modal fade" id="${bbsPostId}" tabindex="-1" aria-labelledby="exampleModalLabel"
                              aria-hidden="true">
                          <div class="modal-dialog modal-dialog-centered">
                            <div class="modal-content">
                              <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">是否取消收藏此篇文章?</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                              </div>
                              <div class="modal-footer">
                                <button type="button" class="btn btn-secondary btn_bbs_cancel1" data-bs-dismiss="modal">
                                  取消
                                </button>
                                <button type="submit" class="btn btn-danger btn_bbs_sure1">
                                  確定
                                </button>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </li>
                  `;
                  if(String(data_id) === String(memId)){
                    $("ul.bbs_favorite_list").append(bbs_favorite_html);
                  }
                }
              },
              error: function(xhr, status, error) {
                // 错误响应处理逻辑
                console.log("請求失敗");
                console.log("狀態碼" + xhr.status);
                console.log("錯誤訊息" + error);
                if(xhr.status == 404){
                  let no_fav_html = `
                <div class=" mt-5 mb-5" style=" display: flex; justify-content: center;  align-items: center; 
                     height: 300px; background-color: rgba(0, 100, 0, 0.5); color: white; text-align: center;"   
                  <h6>無收藏的文章~~</h6>
                </div>
                `
                $("div.bbs_no_fav").append(no_fav_html);
                }
              }
            });
          }
        });
        // ==============================================================================

        // 唯一ID的計數器
        let modalCounterTop = 0;
        let modalIdTop = "exampleModal" + modalCounterTop;
        modalCounterTop++;
        // 唯一ID的計數器
        let modalCounterMid = 0;
        let modalIdMid = "exampleModal" + modalCounterMid;
        modalCounterMid++;

        //=======================================取消收藏=======================================
       
        
       
        
        $("ul.bbs_favorite_list").on( "click", "#bbs_cancel_favorite",function () {
          console.log(this);
          let bbsPostId = $(this).siblings("#bbsPostId_cancel").text();
          console.log(bbsPostId);
          console.log(bbsPostId_cancel);
          console.log("取消收藏的bbspostid");
          let jason_data_fav_cancel = {
          bbsPostId : bbsPostId,
           }
            $(this).closest("li").fadeOut(1000);
            // 淡出效果完成後關閉燈箱效果
            $(this).closest(".bbsPostId").modal("hide");
            $.ajax({
              url: "/bbsdiscussGet/bbsfavpagestatus",
              type: "PUT",
              data: JSON.stringify(jason_data_fav_cancel),
              dataType: "json",
              contentType: "application/json",
              success: function (data_fav_cancel) {
                console.log(data_fav_cancel);
              }
            });
          }
        );

        //跳轉到發表文章
        $(".btn_edit").on("click", function () {
          window.location.href = "/bbsdiscuss/edit.html";
        });
        //跳轉到發文紀錄
        $(".btn_posting_record").on("click", function () {
          window.location.href = "/bbsdiscuss/bsdiscusspo.html";
        });
      });


      function go_herf(type) {
      switch (type) {
        case '語言討論版':
          window.location.href = "/bbsdiscuss/index.html?posttype=語言討論版";
          break;

        case '程式討論版':
          window.location.href = "/bbsdiscuss/index.html?posttype=程式討論版";
          break;

        case '生活討論版':
          window.location.href = "/bbsdiscuss/index.html?posttype=生活討論版";
          break;

        case '電競討論版':
          window.location.href = "/bbsdiscuss/index.html?posttype=電競討論版";
          break;


        default:
          alert('無定義區域')
          break;
      }
    }
    </script>
  </body>
</html>
