<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- bootstrap相關 -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ"
      crossorigin="anonymous"
    ></script>
    <!-- bootstrap相關 -->

    <link href="../css/basebbs.css" rel="stylesheet" type="text/css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@100;300;400;500;700;900&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.ckeditor.com/ckeditor5/37.1.0/classic/ckeditor.js"></script>
    <script src="../jquery/jquery-3.6.4.min.js"></script>
        <!-- 要登入驗證請解開這個 -->
    <!-- <script src="../js/loginCheck.js"></script> -->
    <script src="../js/base.js"></script>

    <title>Document</title>
  </head>

  <body class="TeacherWanted">
    <!-- 手機板導引列(粗糙) -->
    <header class="TeacherWanted">
      <div id="mySidebar">
        <img src="../img/base/logo.png" alt="" />
        <a href="/index" class="">首頁</a>
        <a href="/courseteacher/CourseVue.html" class="">課程</a>
        <a href="/active/activeIndex.html" class="">活動</a>
        <a href="/wish" class="">許願池</a>
        <a href="/bbsdiscuss/index.html" class="">論壇</a>
        <a href="/baseVer3/homepage.html" class="">商城</a>
      </div>
      <div class="navBar">
        <ul class="containerHearder flexWrap flexVerticalCenter">
          <li>
            <img
              src="../img/base/menu.png"
              id="phoneMenu"
              class="mobileHave"
              style="height: 30px; margin: 10px"
              alt=""
            />
          </li>

          <li
            class="flexWrap flexAllCenter"
            style="font-size: 50px; color: #a4c964; margin: 10px 0px"
          >
            <img
              src="../img/base/logo.png"
              class="miniMobile"
              style="height: 50px; margin: 0px 5px"
              alt=""
            />
            <p>懸賞啼雀</p>
          </li>
          <li
            class="flexWrap"
            style="
              flex-grow: 1;
              display: flex;
              align-items: center;
              justify-content: end;
            "
          >
            <!-- 電腦版導引列 -->
            <div
              id="navLink"
              class="flexWrap flexAllCenter pcHave"
              style="flex-grow: 1"
            >
              <a class="flexAllCenter" href="/index">首頁</a>
              <a class="flexAllCenter" href="/courseteacher/CourseVue.html"
                >課程</a
              >
              <a class="flexAllCenter" href="/active/activeIndex.html">活動</a>
              <a class="flexAllCenter" href="/wish">許願池</a>
              <a class="flexAllCenter" href="/bbsdiscuss/index.html">論壇</a>
              <a class="flexAllCenter" href="/baseVer3/homepage.html">商城</a>
            </div>
            <div
              class="flexWrap flexAllCenter"
              style="position: relative; top: 2px"
            >
              <div class="miniMobile">
                <div id="navSearch" action="">
                  <select id="serchType">
                    <option value="課程">課程</option>
                    <option value="活動">活動</option>
                    <!-- <option value="商城">商城</option>
                    <option value="許願">許願</option> -->
                  </select>
                  <input id="searchText" type="text" />
                  <img id="searchIcon" src="../img/base/search.svg" alt="" />
                </div>
              </div>

              <img
                src="../img/base/bell.svg"
                id="navAnn"
                class="miniMobile"
                style="height: 30px; margin: 3px 5px; cursor: pointer"
                alt=""
              />
              <img
                src="../img/base/mailForNavbar.svg"
                id="navMail"
                class="miniMobile"
                style="
                  height: 30px;
                  margin: 3px 5px;
                  cursor: pointer;
                  position: relative;
                  bottom: 1px;
                "
                alt=""
              />
              <img
                src="../img/base/shoppingCart.svg"
                id="navShoppingcart"
                class="miniMobile"
                style="height: 30px; margin: 3px 5px; cursor: pointer"
                alt=""
              />

              <!--登入按鈕 開始 -->

              <div id="loginOrUser"></div>
              <!-- 登入按鈕 結束 -->
            </div>
          </li>
        </ul>
      </div>
    </header>

    <main class="TeacherWanted">
      <div class="container mt-3 mb-3">
        <div class="row align-items-center bbs_header">
          <!-- 開始複製 頭像/基本資料-->
          <!-- bbs_header_html -->
          <!-- 結束複製 頭像/基本資料-->
        </div>
      </div>
      <div class="container text-success mt-3 mb-3 bbs_body">
        <!-- 開始複製填寫資料 -->
        <!-- bbs_body_html -->

        <!-- 結束複製填寫資料 -->
      </div>

      <!-- <button id="send_btn">送出</button> -->
    </main>

    <footer
    class="TeacherWanted"
    style="background-color: #3c6a36; color: white"
  >
    <div
      class="containerFooter flexAllCenter"
      style="box-sizing: border-box; padding-top: 50px"
    >
      <div class="flexWrap">
        <ul class="col_33">
          <li class="flexAllCenter" style="color: #a4c964; font-size: 40px">
            懸賞啼雀
          </li>
          <li
            class="flexAllCenter"
            style="margin: 10px 30px; font-weight: normal"
          >
            現代⼈⽣活步相當緊湊我們的課平台幫助
            ⼈們學並且除了線上課提供了實家的合會⼤了學的⾯向
            課元可提⾼學⽣的學興積性 並促學⽣的⾯發展
          </li>
          <li
            id="imgIcon"
            class="flexVerticalCenter"
            style="margin: 20px 30px"
          >
            <img src="../img/base/facebook.svg" class="imgIntroduce" alt="" />
            <img src="../img/base/twitter.svg" class="imgIntroduce" alt="" />
            <img
              src="../img/base/instagram.svg"
              class="imgIntroduce"
              alt=""
            />
          </li>
        </ul>
        <ul class="col_33 flexHorizontalCenter footerMobile">
          <div style="width: 70%">
            <li
              class="flexAllCenter"
              style="color: #a4c964; font-size: 30px; height: 65px"
            >
              Get In Touch
            </li>
            <div class="" style="height: 250px; font-weight: 400">
              <li class="flexWrap" style="margin-top: 10px">
                <img
                  src="../img/base/map-marker.svg"
                  style="height: 24px; padding-right: 10px; margin-top: 6px"
                  alt=""
                />
                <div>
                  <h3 style="font-size: 1.3rem">地址</h3>
                  <h5 style="font-size: 1rem">台北市中山區南京東路三段</h5>
                </div>
              </li>

              <li class="flexWrap" style="margin-top: 10px">
                <img
                  src="../img/base/mail.svg"
                  style="height: 24px; padding-right: 10px; margin-top: 6px"
                  alt=""
                />
                <div>
                  <h3 style="font-size: 1.3rem">信箱</h3>
                  <h5 style="font-size: 1rem">a1234567890@gmail.com</h5>
                </div>
              </li>

              <li class="flexWrap" style="margin-top: 10px">
                <img
                  src="../img/base/phone.svg"
                  style="height: 24px; padding-right: 10px; margin-top: 6px"
                  alt=""
                />
                <div>
                  <h3 style="font-size: 1.3rem">連絡電話</h3>
                  <h5 style="font-size: 1rem">0900123456</h5>
                </div>
              </li>
            </div>
          </div>
        </ul>
        <ul class="col_33 flexHorizontalCenter footerMobile">
          <div style="width: 40%">
            <li
              class="flexAllCenter"
              style="color: #a4c964; font-size: 30px; height: 65px"
            >
              網站地圖
            </li>
            <div class="webMap">
              <li style="margin-top: 5px">
                <a class="webMapLink" href="/index">>首頁</a>
              </li>
              <li style="margin-top: 5px">
                <a class="webMapLink" href="/courseteacher/CourseVue.html"
                  >>課程</a
                >
              </li>
              <li style="margin-top: 5px">
                <a class="webMapLink" href="/active/activeIndex.html"
                  >>活動</a
                >
              </li>
              <li style="margin-top: 5px">
                <a class="webMapLink" href="/wish">>許願池</a>
              </li>
              <li style="margin-top: 5px">
                <a class="webMapLink" href="/bbsdiscuss/index.html">>論壇</a>
              </li>
              <li style="margin-top: 5px">
                <a class="webMapLink" href="/baseVer3/homepage.html">>商城</a>
              </li>
            </div>
          </div>
        </ul>
      </div>
    </div>
  </footer>

    <script>

      $(function () {
        $("div.bbs_body").html();
        // ============================================DOM 載入完成之後=========================================
        // ====================bbs_header_html====以及======bbs_body_html============================================
        $.ajax({
          url: "/bbsdiscussGet/memberInfo", // 資料請求的網址
          type: "GET", // GET | POST | PUT | DELETE | PATCH
          data: { memId: 1 },
          dataType: "json",
          beforeSend: function () { },
          success: function (data) {
            // request 成功取得回應後執行
            // console.log(data);
            let goodurl = "data:image/" +
              "null" +
              ";base64," +
              data.memPhoto;
            let bbs_header_html = `
                              <div class="col">
                                <img
                                  src="${goodurl}"
                                  class="img-fluid rounded-start"
                                  alt="頭像"
                                />
                              </div>
                              <div class="col-11">
                                <h5 class="card-title text-primary">${data.memName}</h5>
                                <p class="text-muted">樓主</p>
                              </div>
                              `;
            $("div.bbs_header").append(bbs_header_html);
            let bbs_body_html = `
                          <form class="row g-3 bbs_form bbs_body">
                            <div class="col-md-3 bbs_edit_select_one">
                              <label for="validationDefault04" class="form-label">討論區</label>
                              <select
                                class="form-select text-secondary"
                                id="validationDefault04"
                                required
                              >
                                <option selected disabled value="">請選擇</option>
                                <option value="1">語言討論版</option>
                                <option value="2">程式討論版</option>
                                <option value="3">生活討論版</option>
                                <option value="4">電競討論版</option>
                              </select>
                            </div>
                            <div class="col-md-3">
                              <label for="validationDefault05" class="form-label">文章分類</label>
                              <select
                                class="form-select text-secondary"
                                id="validationDefault05"
                                required
                              >
                                <option selected disabled value="">請選擇</option>
                                <option value="1">問題</option>
                                <option value="2">閒聊</option>
                                <option value="3">情報</option>
                                <option value="4">心得</option>
                                <option value="5">其他</option>
                              </select>
                            </div>
                            <div class="form-floating text-success mt-3">
                              <textarea
                                class="form-control"
                                placeholder="Leave a comment here"
                                maxlength="40"
                                id="floatingTextarea"
                                required
                                style="resize: none; height: 80px"
                              ></textarea>
                              <label for="floatingTextarea">輸入文章標題... (0/40字)</label>
                            </div>
                            <div class="container mb-3 text-success mt-3">
                              <div class="form-floating">
                                <textarea
                                  class="form-control"
                                  placeholder="Leave a comment here"
                                  id="floatingTextarea2"
                                  required
                                  style="height: 200px; resize: none"
                                ></textarea>
                                <label for="floatingTextarea2">輸入內文...(0/2000字)</label>
                              </div>
                            </div>
                            <div class="col-md-12">

                              <!-- Button trigger modal -->
                              <button
                                id="btn_give_up_edit"
                                type="button"
                                class="btn btn-success" >
                                返回首頁
                              </button>


                                <!-- Button trigger modal -->
                                <button type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#exampleModal">
                                  送出發文
                                </button>

                                <!-- Modal -->
                                <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                  <div class="modal-dialog">
                                    <div class="modal-content">
                                      <div class="modal-header">
                                        <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                      </div>
                                      <div class="modal-body">
                                        確定發表文章?
                                      </div>
                                      <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                                        <button type="button" class="btn btn-success" onclick="send()" >確定</button>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </form>
                            `;
              $("div.bbs_body").append(bbs_body_html);
            },
            error: function (xhr) {
              // request 發生錯誤的話執行
              console.log("跑到error了");
              console.log(xhr);
            },
            complete: function (xhr) {
            },
          });
        })



      //====================================送出下=============================================

      // =============================================輸入文章標題(限制最多40個字)====================================
      $("#floatingTextarea").on("input", function () {
        var maxLength = 40;
        var currentLength = $(this).var().length;
        // 如果超過最大長度，將多餘的字元刪除
        if (currentLength > maxLength) {
          $(this).val() = $(this).val().slice(0, maxLength);
        }
        // 如果您希望限制最大輸入字數為40，可以添加以下代碼
        var maxChar = 40;
        if (charCount > maxChar) {
          $(this).val(inputText.substring(0, maxChar));
          $('#charCount').text(maxChar);
        }
      });

      //=========================================送出上=========================


      //===============================返回首頁==========================
      $("div.bbs_body").on("click", "#btn_give_up_edit", function () {
        // console.log("有綁掉嗎 要跳回首頁")
        window.location.href = "/bbsdiscuss/index.html?posttype=all";
      })


      async function send() {

        let discuss_dr = $('#validationDefault04 option:selected');
        let post_dr = $('#validationDefault05 option:selected');
        let post_title = $('#floatingTextarea');
        let post_content = $('#floatingTextarea2');

        let discuss_dr_value = discuss_dr.text();
        let post_dr_value = post_dr.text();
        let post_title_value = post_title.val();
        let post_content_value = post_content.val();


        if (discuss_dr_value == "" || post_dr_value == "" || post_title_value == "" || post_content_value == "") {
          // event.preventDefault(); // 阻止表單的預設提交行為
          alert('內容有空值 不送出')
          return
        }
        // console.log("第二個bbs_test_out 有嗎???????")



        // console.log(`討論區:${discuss_dr_value} , 文章分類:${post_dr_value}`)
        // console.log(post_title_value)
        // console.log(post_content_value)

        let json_data = {
          "bbsCategoryName": discuss_dr_value,
          "bbsTagName": post_dr_value,
          "postTitle": post_title_value,
          "postContent": post_content_value
        }

        // console.log(json_data)

        let postValue = await my_ajax("/bbsdiscussGet/post", "POST", json_data)

        //  let postValue  = await  my_ajax("/bbsdiscussGet/post" ,"POST" , json_data )

        window.location.href = "/bbsdiscuss/index.html?posttype=all";

      }


      function my_ajax(url, type, json_data) {

        return new Promise((resolve, reject) => {
          $.ajax({
            url: url, // 資料請求的網址
            type: type, // GET | POST | PUT | DELETE | PATCH
            data: JSON.stringify(json_data),
            dataType: "json",
            contentType: "application/json",
            beforeSend: function () {
            },
            success: function (data) {
              // console.log(data);
              resolve(data)
            },
            error: function (xhr) {
              console.log("error");
              console.log(xhr);
            },
            complete: function (xhr) {
              // window.location.href = "index.html";
            },
          });


        });


      }
      // });
    </script>
  </body>
</html>
